<div id="login-overlay" class="modal-dialog">
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" onclick="location.href='#dashboard'">geri</button>
            <h4 class="modal-title" id="odaAdi"></h4>
        </div>
        <div class="modal-body">
            <div class="row" id="roomInfo">

            </div>
            <div class="row" id="roomContent" style="text-align: center; padding-left: 5px; padding-right: 5px">

            </div>
        </div>
    </div>
</div>
<script>
    var roomId = pageParts[1];
    var room;
    if (!window.socket) {
        window.socket = io.connect();
    }

    socket.on('move', function (data) {
        if (data.room.id == roomId) {
            getRequest('/v1/room/info/' + roomId, function (r) {
                room = r;
                renderRoom();
            });
        }
    })

    getRequest('/v1/room/info/' + roomId, function (r) {
        room = r;
        renderRoom();
    });

    function renderRoom() {
        document.getElementById('odaAdi').innerText = room.name;
        var roomInfo = document.getElementById('roomInfo');

        roomInfo.innerHTML = '<h3 style="margin: 0; float:left">' + room.challenger.name + '  ' + room.challengerCoin + (room.status == 'CHALLENGER' ? ' &lt;&lt;&lt;' : '') + ' </h3>' +
            '<h3 style="margin: 0; float:right">' + (room.status == 'OPPONENT' ? '&gt;&gt;&gt; ' : '') + room.opponentCoin + '  ' + room.opponent.name + '</h3>';
        var roomContent = document.getElementById('roomContent');
        room.ground.split('').forEach(function (c, i) {

            if (c == '?') {
                c = 'dirt';
            } else if (c == 'G') {
                c = 'grass'
            } else if (c == 'C') {
                c = 'coin'
            }
            roomContent.innerHTML += '<div class="col-xs-1 field ' + c + '" fieldId="' + i + '">&nbsp;</div>'
        });

        roomContent.onclick = function (e) {
            var fieldId = e.srcElement.getAttribute('fieldId');
            if (fieldId) {
                socket.emit('move', {
                    roomId: roomId,
                    fieldId: fieldId
                });
            }

        }
    }

</script>